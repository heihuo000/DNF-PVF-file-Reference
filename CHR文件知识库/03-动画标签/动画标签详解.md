# CHR文件动画标签详解

## 概述

动画标签定义了角色的各种动作动画文件引用，包括待机、移动、攻击、受击等所有动作的动画资源。

## 基础动画标签

### 待机动画

#### [stay] - 基础待机动画
```
[stay] `动画文件名.ani`
```

#### [body stay] - 身体待机动画
```
[body stay] `BodyStay.ani`
```

**示例：**
```
[stay] `Stay.ani`
[body stay] `BodyStay.ani`
```

### 移动动画

#### [walk] - 行走动画
```
[walk] `Walk.ani`
```

#### [run] - 跑步动画
```
[run] `Run.ani`
```

#### [dash] - 冲刺动画
```
[dash] `Dash.ani`
```

**示例：**
```
[walk] `Walk.ani`
[run] `Run.ani`
[dash] `Dash.ani`
```

### 跳跃动画

#### [jump] - 跳跃动画
```
[jump] `Jump.ani`
```

#### [jump attack] - 跳跃攻击动画
```
[jump attack] `JumpAttack.ani`
```

#### [down] - 下落动画
```
[down] `Down.ani`
```

**示例：**
```
[jump] `Jump.ani`
[jump attack] `JumpAttack.ani`
[down] `Down.ani`
```

## 攻击动画标签

### 基础攻击

#### [attack1] - 第一段攻击
```
[attack1] `Attack1.ani`
```

#### [attack2] - 第二段攻击
```
[attack2] `Attack2.ani`
```

#### [attack3] - 第三段攻击
```
[attack3] `Attack3.ani`
```

**示例：**
```
[attack1] `Attack1.ani`
[attack2] `Attack2.ani`
[attack3] `Attack3.ani`
```

### 特殊攻击

#### [upper attack] - 上挑攻击
```
[upper attack] `UpperAttack.ani`
```

#### [down attack] - 下劈攻击
```
[down attack] `DownAttack.ani`
```

#### [dash attack] - 冲刺攻击
```
[dash attack] `DashAttack.ani`
```

**示例：**
```
[upper attack] `UpperAttack.ani`
[down attack] `DownAttack.ani`
[dash attack] `DashAttack.ani`
```

## 受击动画标签

### [damage] - 受击动画
```
[damage] `Damage.ani`
```

### [down damage] - 倒地受击
```
[down damage] `DownDamage.ani`
```

### [die] - 死亡动画
```
[die] `Die.ani`
```

**示例：**
```
[damage] `Damage.ani`
[down damage] `DownDamage.ani`
[die] `Die.ani`
```

## 防御动画标签

### [defend] - 防御动画
```
[defend] `Defend.ani`
```

### [defend damage] - 防御受击
```
[defend damage] `DefendDamage.ani`
```

**示例：**
```
[defend] `Defend.ani`
[defend damage] `DefendDamage.ani`
```

## 技能动画标签

### [skill] - 技能动画
技能动画通常在技能文件中定义，但CHR文件中也可以包含基础技能动画。

**语法：**
```
[skill] 技能ID `技能动画.ani`
```

**示例：**
```
[skill] 1001 `Skill_Slash.ani`
[skill] 1002 `Skill_Fireball.ani`
```

## 特殊动画标签

### [casting] - 施法动画
```
[casting] `Casting.ani`
```

### [throw] - 投掷动画
```
[throw] `Throw.ani`
```

### [grab] - 抓取动画
```
[grab] `Grab.ani`
```

### [overturn] - 翻转动画
```
[overturn] `Overturn.ani`
```

**示例：**
```
[casting] `Casting.ani`
[throw] `Throw.ani`
[grab] `Grab.ani`
[overturn] `Overturn.ani`
```

## 动画文件命名规范

### 标准命名格式
```
动作名称.ani
```

### 常用动画文件名
- `Stay.ani` - 待机
- `Walk.ani` - 行走
- `Run.ani` - 跑步
- `Jump.ani` - 跳跃
- `Attack1.ani` - 攻击1
- `Attack2.ani` - 攻击2
- `Attack3.ani` - 攻击3
- `Damage.ani` - 受击
- `Die.ani` - 死亡
- `Defend.ani` - 防御

### 特殊动画文件名
- `BodyStay.ani` - 身体待机
- `JumpAttack.ani` - 跳跃攻击
- `UpperAttack.ani` - 上挑攻击
- `DownAttack.ani` - 下劈攻击
- `DashAttack.ani` - 冲刺攻击
- `DownDamage.ani` - 倒地受击
- `DefendDamage.ani` - 防御受击

## 动画标签组合示例

### 完整的基础动画配置
```
// 待机动画
[stay] `Stay.ani`
[body stay] `BodyStay.ani`

// 移动动画
[walk] `Walk.ani`
[run] `Run.ani`
[dash] `Dash.ani`

// 跳跃动画
[jump] `Jump.ani`
[jump attack] `JumpAttack.ani`
[down] `Down.ani`

// 攻击动画
[attack1] `Attack1.ani`
[attack2] `Attack2.ani`
[attack3] `Attack3.ani`
[upper attack] `UpperAttack.ani`
[down attack] `DownAttack.ani`
[dash attack] `DashAttack.ani`

// 受击动画
[damage] `Damage.ani`
[down damage] `DownDamage.ani`
[die] `Die.ani`

// 防御动画
[defend] `Defend.ani`
[defend damage] `DefendDamage.ani`
```

## 动画文件路径规则

### 相对路径
动画文件通常使用相对路径，相对于角色文件夹：
```
[attack1] `Attack1.ani`  // 在同一目录下
[attack1] `animation/Attack1.ani`  // 在子目录中
```

### 绝对路径
也可以使用绝对路径引用其他位置的动画文件：
```
[attack1] `sprite/character/common/Attack1.ani`
```

## 注意事项

1. **文件存在性**：确保引用的动画文件实际存在
2. **路径格式**：使用正斜杠（/）作为路径分隔符
3. **文件扩展名**：动画文件必须使用 `.ani` 扩展名
4. **字符串格式**：动画文件名必须用反引号（`）包围
5. **大小写敏感**：文件名区分大小写
6. **编码格式**：确保文件名使用正确的字符编码

## 动画优先级

当多个动画可能同时触发时，系统按以下优先级处理：
1. 技能动画（最高优先级）
2. 攻击动画
3. 受击动画
4. 移动动画
5. 待机动画（最低优先级）

## 性能优化建议

1. **动画复用**：相似的动作可以共用同一个动画文件
2. **文件大小**：控制动画文件的大小以提高加载速度
3. **帧数优化**：合理设置动画帧数，避免过度细腻的动画
4. **内存管理**：及时释放不需要的动画资源

## 相关文档

- [攻击信息详解](../04-攻击信息/攻击信息详解.md)
- [完整CHR示例](../06-实际示例/完整CHR示例.md)
- [常见问题解答](../07-常见问题/动画相关问题.md)