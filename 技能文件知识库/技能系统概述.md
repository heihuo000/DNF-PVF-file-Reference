# DNF技能系统概述

## 📋 目录
- [技能系统架构](#技能系统架构)
- [技能文件类型](#技能文件类型)
- [技能修改流程](#技能修改流程)
- [职业技能体系](#职业技能体系)
- [技能树系统](#技能树系统)
- [技能参数详解](#技能参数详解)
- [修改注意事项](#修改注意事项)

## 🏗️ 技能系统架构

DNF的技能系统由以下几个核心组件构成：

### 1. 技能文件 (.skl)
- **位置**：`skill/` 目录下，按职业分类
- **作用**：定义技能的所有属性和行为
- **格式**：文本格式，使用特定标签结构

### 2. 技能列表 (.lst)
- **位置**：`lst/` 目录下
- **作用**：定义每个职业可学习的技能列表
- **命名规则**：`[职业名]Skill.lst`

### 3. 技能树文件 (.co)
- **位置**：`clientonly/skilltree/` 目录下
- **作用**：定义技能在技能树中的位置和布局
- **坐标系统**：使用X,Y坐标定位技能图标

### 4. 技能图标 (.img)
- **位置**：`sprite/` 目录下
- **作用**：技能的视觉图标显示
- **格式**：游戏专用图像格式

## 📁 技能文件类型

### .skl 文件（技能定义文件）
```
[skill]
    [name] `技能名称`
    [explain] `技能描述`
    [basic info]
        [skill type] 0    // 技能类型
        [skill class] 0   // 技能分类
        [maximum level] 70 // 最大等级
        [growtype maximum level] 70 70 70 70 70 70 // 各转职最大等级
    [/basic info]
    
    [required level] 1    // 学习等级要求
    [required sp] 1 1 1 1 1 // SP消耗
    
    [level info]
        // 各等级的技能数据
    [/level info]
[/skill]
```

### .lst 文件（技能列表文件）
```
// 职业技能列表
// 格式：技能ID 技能文件名
0 BasicAttack.skl
1 UpperSlash.skl
2 DownwardSlash.skl
```

### .co 文件（技能树配置文件）
```
// 技能树布局配置
// 格式：技能ID X坐标 Y坐标
0 47 0
1 94 0
2 141 0
```

## 🔄 技能修改流程

### 1. 准备阶段
1. **备份原文件**：复制原始PVF文件
2. **解压PVF**：使用Decrypt工具解压PVF包
3. **定位文件**：找到要修改的技能文件

### 2. 修改阶段
1. **编辑技能文件**：修改.skl文件中的参数
2. **更新技能列表**：如需要，修改.lst文件
3. **调整技能树**：如需要，修改.co文件

### 3. 测试阶段
1. **重新打包**：使用Decrypt工具重新打包PVF
2. **游戏测试**：在游戏中验证修改效果
3. **调试优化**：根据测试结果进行调整

## 👥 职业技能体系

### 职业ID对照表
| 职业ID | 职业名称 | 技能文件 | 技能树文件 |
|--------|----------|----------|------------|
| 0 | 鬼剑士 | SwordmanSkill.lst | swordman.co |
| 1 | 格斗家(女) | FighterSkill.lst | fighter.co |
| 2 | 神枪手(男) | GunnerSkill.lst | gunner.co |
| 3 | 魔法师(女) | MageSkill.lst | mage.co |
| 4 | 圣职者 | PriestSkill.lst | priest.co |
| 5 | 神枪手(女) | ATGunnerSkill.lst | atgunner.co |
| 6 | 盗贼 | ThiefSkill.lst | thief.co |
| 7 | 格斗家(男) | ATFighterSkill.lst | atfighter.co |
| 8 | 魔法师(男) | ATMageSkill.lst | atmage.co |

### 转职系统
每个基础职业都有多个转职方向：
- **鬼剑士**：剑魂、狂战士、鬼泣、阿修罗
- **格斗家**：散打、柔道、气功师、街霸
- **神枪手**：漫游枪手、机械师、枪炮师、弹药专家
- **魔法师**：元素师、召唤师、战斗法师、魔道学者
- **圣职者**：圣骑士、蓝拳圣使、驱魔师、复仇者

## 🌳 技能树系统

### 坐标系统
- **原点**：技能树左上角为(0,0)
- **单位**：每个技能图标占用47x47像素
- **间距**：技能图标间距通常为47像素

### 常用坐标位置
```
第一排：Y = 0
- 第1列：X = 47
- 第2列：X = 94
- 第3列：X = 141

第二排：Y = 47
- 第1列：X = 47
- 第2列：X = 94
- 第3列：X = 141
```

### 技能连线
技能之间的前置关系通过以下方式定义：
```
[required skill]
    [skill] 前置技能ID
    [level] 前置技能等级
[/required skill]
```

## 🔧 技能参数详解

### 基础参数
- **skill type**：技能类型（0=主动，1=被动，2=觉醒等）
- **skill class**：技能分类（影响技能在技能树中的分组）
- **maximum level**：技能最大等级
- **required level**：学习所需角色等级
- **required sp**：每级所需SP点数

### 伤害参数
- **physical attack**：物理攻击力
- **magical attack**：魔法攻击力
- **attack range**：攻击范围
- **hit recovery**：硬直时间

### 特殊效果
- **status**：状态效果（中毒、冰冻、眩晕等）
- **buff**：增益效果
- **debuff**：减益效果
- **summon**：召唤物设置

## ⚠️ 修改注意事项

### 1. 格式规范
```
✅ 正确格式：
[name] `血影·鬼切`

❌ 错误格式：
[name] "血影·鬼切"
```

### 2. 缩进规范
- 使用Tab键进行缩进，不要使用空格
- 保持标签层次结构的一致性

### 3. 数值范围
- **等级范围**：1-70（部分技能可能更高）
- **SP消耗**：建议不超过100
- **伤害倍率**：避免设置过高导致游戏失衡

### 4. 兼容性考虑
- 不同版本的技能文件可能有差异
- 修改前确认当前版本的文件结构
- 测试时注意客户端和服务端的同步

### 5. 性能影响
- 避免创建过多技能导致服务器负载过重
- 复杂的技能效果可能影响游戏性能
- 合理设置技能冷却时间和消耗

## 🔗 相关文档

- [标签参考.md](标签参考.md) - 详细的标签说明
- [示例文件/](示例文件/) - 实用的修改示例
- [职业技能参考/](职业技能参考/) - 各职业技能详解
- [问题解答.md](问题解答.md) - 常见问题解决方案

---

**提示**：技能修改是一个需要耐心和细心的过程，建议从简单的参数修改开始，逐步掌握更复杂的技能创建技巧。