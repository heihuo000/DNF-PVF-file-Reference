# 配方STK文件详解

## 📋 概述

配方是DNF中用于制作系统的STK文件类型，定义了制作物品所需的材料、技能要求和产出结果。

## 🏷️ 基本标签结构

### 物品基本信息
```
[name] `高级武器制作配方`         // 配方名称
[name2] `Advanced Weapon Recipe` // 英文名称(可选)
[explain]                         // 配方说明开始
`制作高级武器的珍贵配方
需要高超的工艺技能才能使用`
[/explain]                        // 配方说明结束
[flavor text] `大师的秘籍`         // 风味文本
```

### 等级与稀有度
```
[grade] 55                        // 配方等级
[rarity] 2                        // 稀有度 (配方通常较稀有)
[weight] 3                        // 重量 (配方通常较轻)
[minimum level] 50                // 使用最低等级
```

## 📦 配方类型

### 类型定义
```
[stackable type] `[recipe]` 0     // 配方类型
```

### 子类型分类
```
[sub type] 1                      // 子类型
```

**配方子类型**:
- `0` - 普通配方
- `1` - 高级配方
- `2` - 专家配方
- `3` - 大师配方
- `4` - 特殊配方

## 💰 经济属性

### 交易属性
```
[attach type] `[trade]`           // 交易类型
// 配方通常可交易
```

### 价格设定
```
[price] 15000                     // NPC购买价格
[value] 7500                      // NPC出售价格
[creation rate] 2                 // 生成概率 (较低)
```

## 🔧 配方制作系统

### 配方数据结构
```
[int data]                        // 整数数据开始

// 需要材料部分
3                                // 需要材料种类数
27001 5                          // 材料ID 数量
27002 10                         // 材料ID 数量  
27003 3                          // 材料ID 数量

// 产出物品部分
2                                // 产出物品种类数
10501 1                          // 产出物品ID 数量
10502 1                          // 产出物品ID 数量

// 技能要求部分
2                                // 需要技能种类数
140 5                            // 技能ID 最低等级
142 8                            // 技能ID 最低等级

// 制作等级要求
2                                // 制作等级要求
// 0: 全部等级可制作
// 1: 高级制作师
// 2: 专家制作师

[/int data]                      // 整数数据结束
```

### 制作类型
```
[string data]                     // 字符串数据开始
`[craftmanship]`                 // 制作类型
[/string data]                   // 字符串数据结束
```

**制作类型说明**:
- `[craftmanship]` - 工艺制作 (武器、防具)
- `[weaving]` - 纺织制作 (布甲、皮甲)
- `[machinary]` - 机械制作 (枪械、机械装备)
- `[chemistry]` - 化学制作 (药水、炸弹)
- `[enchant]` - 附魔制作 (附魔卷轴)

## 🎯 技能要求系统

### 技能ID对照
```
// 常用制作技能ID:
140 - 基础工艺
141 - 高级工艺
142 - 专家工艺
143 - 大师工艺

150 - 基础纺织
151 - 高级纺织
152 - 专家纺织

160 - 基础机械
161 - 高级机械
162 - 专家机械

170 - 基础化学
171 - 高级化学
172 - 专家化学

180 - 基础附魔
181 - 高级附魔
182 - 专家附魔
```

### 制作等级要求
```
// 制作等级说明:
0 - 所有等级制作师都可使用
1 - 需要高级制作师资格
2 - 需要专家制作师资格
```

## 🎨 视觉与音效

### 图标设定
```
[icon] `RecipeIcon.img` 20        // 配方图标
[field image] `RecipeField.img` 10 // 掉落显示图像
```

### 音效设定
```
[move wav] `RECIPE_TOUCH`         // 移动音效
[use wav] `RECIPE_USE`            // 使用音效
```

## 📋 完整示例

### 武器制作配方示例
```
[name] `传说武器制作配方`
[explain]
`制作传说级武器的珍贵配方
需要大师级工艺技能和稀有材料`
[grade] 70
[rarity] 4
[attach type] `[trade]`
[creation rate] 1
[weight] 2
[usable job]
`[all]`
[/usable job]
[minimum level] 65
[stackable type] `[recipe]` 0
[sub type] 3
[icon] `RecipeIcon.img` 35
[field image] `RecipeField.img` 18
[price] 50000
[value] 25000
[move wav] `RECIPE_TOUCH`
[use wav] `RECIPE_USE`
[stack limit] 1
[int data]
5
28001 10
28002 5
28003 3
28004 1
28005 20

1
11501 1

3
140 10
142 8
143 5

2
[/int data]
[string data]
`[craftmanship]`
[/string data]
```

### 药水制作配方示例
```
[name] `高级恢复药水配方`
[explain]
`制作高级恢复药水的配方
需要化学制作技能`
[grade] 45
[rarity] 2
[attach type] `[trade]`
[creation rate] 5
[weight] 1
[usable job]
`[all]`
[/usable job]
[minimum level] 40
[stackable type] `[recipe]` 0
[sub type] 1
[icon] `RecipeIcon.img` 25
[field image] `RecipeField.img` 12
[price] 8000
[value] 4000
[move wav] `RECIPE_TOUCH`
[use wav] `RECIPE_USE`
[stack limit] 1
[int data]
4
29001 5
29002 3
29003 2
29004 1

2
21501 5
21502 3

2
170 5
171 3

1
[/int data]
[string data]
`[chemistry]`
[/string data]
```

### 附魔卷轴配方示例
```
[name] `力量附魔卷轴配方`
[explain]
`制作力量附魔卷轴的配方
可为装备附加力量属性`
[grade] 35
[rarity] 2
[attach type] `[trade]`
[creation rate] 6
[weight] 1
[usable job]
`[all]`
[/usable job]
[minimum level] 30
[stackable type] `[recipe]` 0
[sub type] 1
[icon] `RecipeIcon.img` 30
[field image] `RecipeField.img` 15
[price] 5000
[value] 2500
[move wav] `RECIPE_TOUCH`
[use wav] `RECIPE_USE`
[stack limit] 1
[int data]
3
30001 3
30002 5
30003 1

1
22501 1

2
180 3
181 1

1
[/int data]
[string data]
`[enchant]`
[/string data]
```

### 复杂制作配方示例
```
[name] `史诗装备套装配方`
[explain]
`制作完整史诗装备套装的大师配方
需要最高级的制作技能和大量珍贵材料`
[grade] 85
[rarity] 5
[attach type] `[account]`
[creation rate] 0
[weight] 5
[usable job]
`[all]`
[/usable job]
[minimum level] 80
[stackable type] `[recipe]` 0
[sub type] 4
[icon] `RecipeIcon.img` 50
[field image] `RecipeField.img` 25
[price] 0
[value] 0
[move wav] `RECIPE_TOUCH`
[use wav] `RECIPE_USE`
[stack limit] 1
[int data]
8
31001 20
31002 15
31003 10
31004 5
31005 3
31006 1
31007 50
31008 100

5
12001 1
12002 1
12003 1
12004 1
12005 1

4
140 15
142 12
143 10
144 8

2
[/int data]
[string data]
`[craftmanship]`
[/string data]
```

## 💡 设计建议

### 材料平衡
1. **稀有度匹配**: 材料稀有度应与产出物品匹配
2. **数量合理**: 避免需要过多材料
3. **获取途径**: 确保材料有合理的获取途径

### 技能要求
1. **等级合理**: 技能等级要求应与配方等级匹配
2. **类型对应**: 制作类型应与产出物品类型对应
3. **进阶性**: 高级配方需要更高技能等级

### 经济平衡
1. **成本效益**: 制作成本应低于产出价值
2. **市场影响**: 考虑对游戏经济的影响
3. **稀缺性**: 保持高级配方的稀缺性

### 用户体验
1. **清晰说明**: 准确描述制作要求和产出
2. **合理分类**: 按制作类型合理分类
3. **进度感**: 提供技能进阶的成就感

## 🔗 相关链接

- [增强剂详解](增强剂详解.md)
- [投掷物品详解](投掷物品详解.md)
- [材料详解](../01-基础STK类型/材料详解.md)
- [实用工具](../04-实用工具/)