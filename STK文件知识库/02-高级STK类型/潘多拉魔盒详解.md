# 潘多拉魔盒STK文件详解

## 📋 概述

潘多拉魔盒是DNF中的特殊STK文件类型，用于创建随机奖励系统。玩家使用后可以随机获得预设列表中的物品，常用于活动奖励和抽奖系统。

## 🏷️ 基本标签结构

### 物品基本信息
```
[name] `神秘潘多拉魔盒`          // 魔盒名称
[name2] `Mystery Pandora Box`   // 英文名称(可选)
[explain]                       // 物品说明开始
`神秘的潘多拉魔盒
打开后可以随机获得珍贵物品
可能包含稀有装备、材料或金币`
[/explain]                      // 物品说明结束
[flavor text] `命运的馈赠`       // 风味文本
```

### 等级与稀有度
```
[grade] 50                      // 魔盒等级
[rarity] 4                      // 稀有度 (通常较高)
[weight] 5                      // 重量
[minimum level] 45              // 使用最低等级
```

## 📦 潘多拉魔盒类型

### 类型定义
```
[stackable type] `[pandora box]` 0 // 潘多拉魔盒类型
```

### 子类型分类
```
[sub type] 1                    // 子类型
```

**潘多拉魔盒子类型**:
- `0` - 普通魔盒
- `1` - 高级魔盒
- `2` - 稀有魔盒
- `3` - 史诗魔盒
- `4` - 传说魔盒
- `5` - 活动魔盒

## 💰 经济属性

### 交易属性
```
[attach type] `[account]`       // 通常绑定账号
// 或 `[trade]` 允许交易
```

### 价格设定
```
[price] 0                       // 通常不可购买
[value] 10000                   // NPC出售价格
[creation rate] 0               // 通常不随机生成
```

## 🎲 奖励系统配置

### 奖励数据结构
```
[int data]                      // 整数数据开始

// 默认奖励物品
25001                          // 默认物品ID (如果抽奖失败给予)

// 奖励物品列表
8                              // 奖励物品种类数

// 物品1: 稀有武器
11001                          // 物品ID
5000                           // 概率 (5000/100000 = 5%)
1                              // 数量

// 物品2: 高级防具
12001                          // 物品ID
8000                           // 概率 (8000/100000 = 8%)
1                              // 数量

// 物品3: 强化材料
21001                          // 物品ID
15000                          // 概率 (15000/100000 = 15%)
5                              // 数量

// 物品4: 金币
1                              // 金币ID
25000                          // 概率 (25000/100000 = 25%)
50000                          // 数量

// 物品5: 经验药水
22001                          // 物品ID
20000                          // 概率 (20000/100000 = 20%)
3                              // 数量

// 物品6: 普通材料
23001                          // 物品ID
15000                          // 概率 (15000/100000 = 15%)
10                             // 数量

// 物品7: 消耗品
24001                          // 物品ID
10000                          // 概率 (10000/100000 = 10%)
2                              // 数量

// 物品8: 特殊道具
25001                          // 物品ID
2000                           // 概率 (2000/100000 = 2%)
1                              // 数量

[/int data]                    // 整数数据结束
```

## 🎯 概率系统说明

### 概率计算
```
// 概率以100,000为基数计算
// 例如: 5000 = 5000/100000 = 5%

总概率检查:
5000 + 8000 + 15000 + 25000 + 20000 + 15000 + 10000 + 2000 = 100000
= 100% (推荐总概率为100%)
```

### 概率分配建议
```
// 稀有度分配参考:
传说物品: 1-3%     (1000-3000)
史诗物品: 3-8%     (3000-8000)
稀有物品: 8-15%    (8000-15000)
高级物品: 15-25%   (15000-25000)
普通物品: 25-40%   (25000-40000)
基础物品: 20-30%   (20000-30000)
```

## 🎨 视觉与音效

### 图标设定
```
[icon] `PandoraIcon.img` 25     // 魔盒图标
[field image] `PandoraField.img` 12 // 掉落显示图像
```

### 音效设定
```
[move wav] `PANDORA_TOUCH`      // 移动音效
[use wav] `PANDORA_OPEN`        // 开启音效
```

## 📋 完整示例

### 新手魔盒示例
```
[name] `新手福利魔盒`
[explain]
`为新手冒险者准备的福利魔盒
包含各种有用的装备和道具
帮助新手快速成长`
[grade] 15
[rarity] 2
[attach type] `[account]`
[creation rate] 0
[weight] 3
[usable job]
`[all]`
[/usable job]
[minimum level] 10
[stackable type] `[pandora box]` 0
[sub type] 0
[icon] `PandoraIcon.img` 10
[field image] `PandoraField.img` 5
[price] 0
[value] 1000
[move wav] `PANDORA_TOUCH`
[use wav] `PANDORA_OPEN`
[stack limit] 10
[int data]
20001
6
10001
20000
1
10002
25000
1
20001
30000
5
1
15000
10000
21001
8000
3
22001
2000
1
[/int data]
```

### 高级魔盒示例
```
[name] `传说宝藏魔盒`
[explain]
`蕴含传说力量的宝藏魔盒
有机会获得极其珍贵的传说装备
以及大量的强化材料和金币`
[grade] 70
[rarity] 5
[attach type] `[account]`
[creation rate] 0
[weight] 8
[usable job]
`[all]`
[/usable job]
[minimum level] 65
[stackable type] `[pandora box]` 0
[sub type] 4
[icon] `PandoraIcon.img` 50
[field image] `PandoraField.img` 25
[price] 0
[value] 50000
[move wav] `PANDORA_TOUCH`
[use wav] `PANDORA_OPEN`
[stack limit] 5
[int data]
30001
10
13001
1000
1
13002
2000
1
13003
3000
1
12001
8000
1
12002
10000
1
31001
20000
10
31002
25000
5
1
15000
100000
32001
10000
3
33001
5000
1
[/int data]
```

### 活动魔盒示例
```
[name] `春节庆典魔盒`
[explain]
`春节活动特别魔盒
包含节日限定装备和道具
以及丰厚的节日奖励`
[grade] 45
[rarity] 3
[attach type] `[account]`
[creation rate] 0
[weight] 4
[usable job]
`[all]`
[/usable job]
[minimum level] 1
[stackable type] `[pandora box]` 0
[sub type] 5
[icon] `PandoraIcon.img` 35
[field image] `PandoraField.img` 18
[price] 0
[value] 8000
[move wav] `PANDORA_TOUCH`
[use wav] `PANDORA_OPEN`
[stack limit] 20
[int data]
40001
12
14001
5000
1
14002
8000
1
14003
3000
1
41001
15000
1
41002
20000
3
41003
25000
5
1
10000
50000
42001
8000
2
42002
5000
1
43001
3000
1
44001
2000
1
45001
1000
1
[/int data]
```

### 材料魔盒示例
```
[name] `强化材料魔盒`
[explain]
`专门提供强化材料的魔盒
包含各种等级的强化石
以及稀有的强化保护券`
[grade] 35
[rarity] 2
[attach type] `[trade]`
[creation rate] 2
[weight] 6
[usable job]
`[all]`
[/usable job]
[minimum level] 30
[stackable type] `[pandora box]` 0
[sub type] 1
[icon] `PandoraIcon.img` 20
[field image] `PandoraField.img` 10
[price] 5000
[value] 2500
[move wav] `PANDORA_TOUCH`
[use wav] `PANDORA_OPEN`
[stack limit] 50
[int data]
50001
7
51001
30000
10
51002
25000
5
51003
20000
3
52001
15000
2
52002
8000
1
53001
1500
1
53002
500
1
[/int data]
```

### 职业专用魔盒示例
```
[name] `剑士专用魔盒`
[explain]
`专为剑士职业设计的魔盒
包含剑士专用装备和技能书
以及职业特色道具`
[grade] 40
[rarity] 3
[attach type] `[trade]`
[creation rate] 3
[weight] 5
[usable job]
`[swordman]`
[/usable job]
[minimum level] 35
[stackable type] `[pandora box]` 0
[sub type] 2
[icon] `PandoraIcon.img` 30
[field image] `PandoraField.img` 15
[price] 8000
[value] 4000
[move wav] `PANDORA_TOUCH`
[use wav] `PANDORA_OPEN`
[stack limit] 30
[int data]
60001
8
61001
15000
1
61002
12000
1
61003
10000
1
62001
20000
1
62002
15000
1
63001
18000
3
64001
8000
1
65001
2000
1
[/int data]
```

## 💡 设计建议

### 概率设计
1. **合理分配**: 确保各稀有度物品概率合理
2. **保底机制**: 设置默认奖励避免玩家失望
3. **总概率**: 建议总概率为100%，避免空奖

### 奖励平衡
1. **价值匹配**: 奖励价值应与魔盒获取难度匹配
2. **稀有度**: 高稀有度物品概率要低
3. **实用性**: 确保奖励对玩家有实际价值

### 用户体验
1. **期待感**: 营造开启的期待感和仪式感
2. **公平性**: 概率要公开透明
3. **多样性**: 提供多种类型的奖励

### 经济影响
1. **市场冲击**: 考虑对游戏经济的影响
2. **通胀控制**: 避免过多金币奖励
3. **稀缺性**: 保持稀有物品的稀缺性

## 🔗 相关链接

- [增强剂详解](增强剂详解.md)
- [传承装备详解](传承装备详解.md)
- [消耗品详解](../01-基础STK类型/消耗品详解.md)
- [实用工具](../04-实用工具/)