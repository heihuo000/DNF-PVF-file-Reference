# STKæ•°å€¼è®¡ç®—å™¨

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›STKæ–‡ä»¶ä¸­å„ç§æ•°å€¼çš„è®¡ç®—æ–¹æ³•å’Œå·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…è®¾è®¡å¹³è¡¡çš„æ¸¸æˆæ•°å€¼ã€‚

## ğŸ§® åŸºç¡€æ•°å€¼è®¡ç®—

### ç­‰çº§ä¸å±æ€§å…³ç³»
```python
def calculate_base_stats(level):
    """æ ¹æ®ç­‰çº§è®¡ç®—åŸºç¡€å±æ€§æ¨èå€¼"""
    base_hp = level * 15 + 100
    base_mp = level * 10 + 50
    base_attack = level * 3 + 10
    base_defense = level * 2 + 5
    
    return {
        'hp': base_hp,
        'mp': base_mp,
        'attack': base_attack,
        'defense': base_defense
    }

# ç¤ºä¾‹ä½¿ç”¨
level_30_stats = calculate_base_stats(30)
print(f"30çº§æ¨èå±æ€§: {level_30_stats}")
# è¾“å‡º: 30çº§æ¨èå±æ€§: {'hp': 550, 'mp': 350, 'attack': 100, 'defense': 65}
```

### ä»·æ ¼è®¡ç®—å…¬å¼
```python
def calculate_item_price(level, rarity, item_type):
    """è®¡ç®—ç‰©å“ä»·æ ¼"""
    # åŸºç¡€ä»·æ ¼
    base_price = level * 100
    
    # ç¨€æœ‰åº¦å€æ•°
    rarity_multiplier = {
        1: 1.0,    # æ™®é€š
        2: 1.5,    # é«˜çº§
        3: 2.5,    # ç¨€æœ‰
        4: 4.0,    # å²è¯—
        5: 7.0,    # ä¼ è¯´
        6: 12.0    # ç¥å™¨
    }
    
    # ç±»å‹å€æ•°
    type_multiplier = {
        'consumable': 1.0,
        'material': 0.8,
        'booster': 3.0,
        'recipe': 2.0,
        'throw item': 1.5,
        'pandora box': 5.0,
        'legacy': 8.0,
        'quest': 0.0
    }
    
    price = base_price * rarity_multiplier.get(rarity, 1.0) * type_multiplier.get(item_type, 1.0)
    return int(price)

# ç¤ºä¾‹è®¡ç®—
price = calculate_item_price(level=35, rarity=3, item_type='consumable')
print(f"35çº§ç¨€æœ‰æ¶ˆè€—å“å»ºè®®ä»·æ ¼: {price}")
# è¾“å‡º: 35çº§ç¨€æœ‰æ¶ˆè€—å“å»ºè®®ä»·æ ¼: 8750
```

### å›æ”¶ä»·å€¼è®¡ç®—
```python
def calculate_sell_value(buy_price, rarity):
    """è®¡ç®—å›æ”¶ä»·å€¼"""
    # åŸºç¡€å›æ”¶ç‡
    base_rate = 0.5
    
    # ç¨€æœ‰åº¦è°ƒæ•´
    rarity_adjustment = {
        1: 0.4,    # æ™®é€šç‰©å“å›æ”¶ç‡ä½
        2: 0.45,   # é«˜çº§
        3: 0.5,    # ç¨€æœ‰
        4: 0.55,   # å²è¯—
        5: 0.6,    # ä¼ è¯´
        6: 0.65    # ç¥å™¨å›æ”¶ç‡é«˜
    }
    
    rate = rarity_adjustment.get(rarity, base_rate)
    return int(buy_price * rate)

# ç¤ºä¾‹è®¡ç®—
sell_value = calculate_sell_value(buy_price=10000, rarity=4)
print(f"å²è¯—ç‰©å“å›æ”¶ä»·å€¼: {sell_value}")
# è¾“å‡º: å²è¯—ç‰©å“å›æ”¶ä»·å€¼: 5500
```

## âš–ï¸ å¹³è¡¡æ€§è®¡ç®—

### æ¶ˆè€—å“æ•ˆæœè®¡ç®—
```python
def calculate_consumable_effect(level, duration_seconds=0):
    """è®¡ç®—æ¶ˆè€—å“æ•ˆæœæ•°å€¼"""
    if duration_seconds == 0:
        # ç¬é—´æ¢å¤ç±»
        hp_restore = level * 20 + 100
        mp_restore = level * 15 + 50
    else:
        # æŒç»­æ•ˆæœç±»
        duration_minutes = duration_seconds / 60000
        total_effect = level * 10 + 50
        hp_restore = int(total_effect / max(1, duration_minutes))
        mp_restore = int(hp_restore * 0.8)
    
    return {
        'hp_restore': hp_restore,
        'mp_restore': mp_restore,
        'suggested_cooldown': max(3000, duration_seconds // 2)
    }

# ç¤ºä¾‹è®¡ç®—
instant_potion = calculate_consumable_effect(level=40)
buff_potion = calculate_consumable_effect(level=40, duration_seconds=300000)  # 5åˆ†é’Ÿ

print(f"40çº§ç¬é—´è¯æ°´: {instant_potion}")
print(f"40çº§å¢ç›Šè¯æ°´: {buff_potion}")
```

### å±æ€§å¢å¼ºè®¡ç®—
```python
def calculate_stat_boost(base_stat, level, duration_seconds):
    """è®¡ç®—å±æ€§å¢å¼ºæ•°å€¼"""
    # åŸºç¡€å¢å¼ºæ¯”ä¾‹ï¼ˆæ ¹æ®æŒç»­æ—¶é—´è°ƒæ•´ï¼‰
    duration_minutes = duration_seconds / 60000
    
    if duration_minutes <= 5:
        boost_percentage = 0.3  # çŸ­æœŸé«˜æ•ˆæœ
    elif duration_minutes <= 15:
        boost_percentage = 0.2  # ä¸­æœŸä¸­æ•ˆæœ
    else:
        boost_percentage = 0.15  # é•¿æœŸä½æ•ˆæœ
    
    # ç­‰çº§è°ƒæ•´
    level_factor = 1 + (level - 1) * 0.02
    
    boost_value = int(base_stat * boost_percentage * level_factor)
    return boost_value

# ç¤ºä¾‹è®¡ç®—
strength_boost = calculate_stat_boost(base_stat=100, level=35, duration_seconds=600000)
print(f"35çº§åŠ›é‡å¢å¼ºæ•ˆæœ: +{strength_boost}")
```

## ğŸ² æ¦‚ç‡è®¡ç®—

### æŠ½å¥–æ¦‚ç‡è®¾è®¡
```python
def design_lottery_rates(total_items, rare_items, epic_items, legend_items):
    """è®¾è®¡æŠ½å¥–æ¦‚ç‡"""
    # æ€»æ¦‚ç‡ä¸º100000ï¼ˆä¸‡åˆ†æ¯”ï¼‰
    total_rate = 100000
    
    # ä¼ è¯´ç‰©å“æ¦‚ç‡ï¼ˆé€šå¸¸0.1-1%ï¼‰
    legend_rate = max(100, total_rate // (total_items * 20))
    
    # å²è¯—ç‰©å“æ¦‚ç‡ï¼ˆé€šå¸¸1-5%ï¼‰
    epic_rate = max(500, total_rate // (total_items * 4))
    
    # ç¨€æœ‰ç‰©å“æ¦‚ç‡ï¼ˆé€šå¸¸5-15%ï¼‰
    rare_rate = max(2000, total_rate // (total_items * 2))
    
    # æ™®é€šç‰©å“æ¦‚ç‡ï¼ˆå‰©ä½™æ¦‚ç‡ï¼‰
    normal_rate = total_rate - (legend_rate * legend_items + 
                               epic_rate * epic_items + 
                               rare_rate * rare_items)
    
    return {
        'legend_rate': legend_rate,
        'epic_rate': epic_rate,
        'rare_rate': rare_rate,
        'normal_rate': normal_rate,
        'total_check': legend_rate * legend_items + epic_rate * epic_items + 
                      rare_rate * rare_items + normal_rate
    }

# ç¤ºä¾‹è®¾è®¡
lottery_design = design_lottery_rates(
    total_items=10, rare_items=3, epic_items=2, legend_items=1
)
print(f"æŠ½å¥–æ¦‚ç‡è®¾è®¡: {lottery_design}")
```

### æˆåŠŸç‡è®¡ç®—
```python
def calculate_success_rate(base_rate, enhancement_level, item_rarity):
    """è®¡ç®—å¼ºåŒ–æˆåŠŸç‡"""
    # åŸºç¡€æˆåŠŸç‡
    success_rate = base_rate
    
    # å¼ºåŒ–ç­‰çº§å½±å“
    level_penalty = enhancement_level * 5  # æ¯çº§é™ä½5%
    success_rate -= level_penalty
    
    # ç¨€æœ‰åº¦å½±å“
    rarity_bonus = {
        1: 0,    # æ™®é€šæ— åŠ æˆ
        2: 5,    # é«˜çº§+5%
        3: 10,   # ç¨€æœ‰+10%
        4: 15,   # å²è¯—+15%
        5: 20,   # ä¼ è¯´+20%
        6: 25    # ç¥å™¨+25%
    }
    
    success_rate += rarity_bonus.get(item_rarity, 0)
    
    # ç¡®ä¿åœ¨åˆç†èŒƒå›´å†…
    return max(5, min(95, success_rate))

# ç¤ºä¾‹è®¡ç®—
success_rate = calculate_success_rate(
    base_rate=80, enhancement_level=7, item_rarity=4
)
print(f"å²è¯—è£…å¤‡+7æˆåŠŸç‡: {success_rate}%")
```

## ğŸ“Š ç»æµå¹³è¡¡è®¡ç®—

### é€šèƒ€æ§åˆ¶è®¡ç®—
```python
def calculate_inflation_control(current_price, market_supply, market_demand):
    """è®¡ç®—é€šèƒ€æ§åˆ¶ä»·æ ¼"""
    # ä¾›éœ€æ¯”ä¾‹
    supply_demand_ratio = market_supply / max(1, market_demand)
    
    # ä»·æ ¼è°ƒæ•´å› å­
    if supply_demand_ratio > 1.5:
        # ä¾›è¿‡äºæ±‚ï¼Œé™ä»·
        adjustment_factor = 0.8
    elif supply_demand_ratio < 0.7:
        # ä¾›ä¸åº”æ±‚ï¼Œæ¶¨ä»·
        adjustment_factor = 1.2
    else:
        # å¹³è¡¡çŠ¶æ€
        adjustment_factor = 1.0
    
    adjusted_price = int(current_price * adjustment_factor)
    return adjusted_price

# ç¤ºä¾‹è®¡ç®—
new_price = calculate_inflation_control(
    current_price=1000, market_supply=150, market_demand=100
)
print(f"è°ƒæ•´åä»·æ ¼: {new_price}")
```

### é‡‘å¸äº§å‡ºè®¡ç®—
```python
def calculate_gold_generation(player_level, activity_type, time_minutes):
    """è®¡ç®—é‡‘å¸äº§å‡º"""
    # åŸºç¡€äº§å‡ºç‡ï¼ˆæ¯åˆ†é’Ÿï¼‰
    base_rate = player_level * 10
    
    # æ´»åŠ¨ç±»å‹å€æ•°
    activity_multiplier = {
        'dungeon': 1.5,
        'quest': 1.0,
        'trade': 0.8,
        'farming': 1.2,
        'pvp': 0.9
    }
    
    multiplier = activity_multiplier.get(activity_type, 1.0)
    total_gold = int(base_rate * multiplier * time_minutes)
    
    return total_gold

# ç¤ºä¾‹è®¡ç®—
gold_earned = calculate_gold_generation(
    player_level=45, activity_type='dungeon', time_minutes=30
)
print(f"45çº§ç©å®¶30åˆ†é’Ÿåœ°ä¸‹åŸæ”¶ç›Š: {gold_earned}é‡‘å¸")
```

## ğŸ› ï¸ å®ç”¨è®¡ç®—å·¥å…·

### åœ¨çº¿è®¡ç®—å™¨HTML
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STKæ•°å€¼è®¡ç®—å™¨</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .calculator { max-width: 600px; margin: 0 auto; }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="calculator">
        <h1>STKæ•°å€¼è®¡ç®—å™¨</h1>
        
        <div class="form-group">
            <label for="level">ç‰©å“ç­‰çº§:</label>
            <input type="number" id="level" min="1" max="85" value="30">
        </div>
        
        <div class="form-group">
            <label for="rarity">ç¨€æœ‰åº¦:</label>
            <select id="rarity">
                <option value="1">æ™®é€š</option>
                <option value="2">é«˜çº§</option>
                <option value="3" selected>ç¨€æœ‰</option>
                <option value="4">å²è¯—</option>
                <option value="5">ä¼ è¯´</option>
                <option value="6">ç¥å™¨</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="itemType">ç‰©å“ç±»å‹:</label>
            <select id="itemType">
                <option value="consumable" selected>æ¶ˆè€—å“</option>
                <option value="material">ææ–™</option>
                <option value="booster">å¢å¼ºå‰‚</option>
                <option value="recipe">é…æ–¹</option>
                <option value="throw item">æŠ•æ·ç‰©å“</option>
                <option value="pandora box">æ½˜å¤šæ‹‰é­”ç›’</option>
                <option value="legacy">ä¼ æ‰¿è£…å¤‡</option>
            </select>
        </div>
        
        <button onclick="calculateValues()">è®¡ç®—æ•°å€¼</button>
        
        <div id="result" class="result" style="display: none;">
            <h3>è®¡ç®—ç»“æœ:</h3>
            <div id="resultContent"></div>
        </div>
    </div>

    <script>
        function calculateValues() {
            const level = parseInt(document.getElementById('level').value);
            const rarity = parseInt(document.getElementById('rarity').value);
            const itemType = document.getElementById('itemType').value;
            
            // ä»·æ ¼è®¡ç®—
            const basePrice = level * 100;
            const rarityMultiplier = [1.0, 1.5, 2.5, 4.0, 7.0, 12.0][rarity - 1];
            const typeMultiplier = {
                'consumable': 1.0,
                'material': 0.8,
                'booster': 3.0,
                'recipe': 2.0,
                'throw item': 1.5,
                'pandora box': 5.0,
                'legacy': 8.0
            };
            
            const price = Math.floor(basePrice * rarityMultiplier * typeMultiplier[itemType]);
            const sellValue = Math.floor(price * (0.4 + rarity * 0.05));
            
            // å±æ€§è®¡ç®—
            const baseStats = {
                hp: level * 15 + 100,
                mp: level * 10 + 50,
                attack: level * 3 + 10,
                defense: level * 2 + 5
            };
            
            // æ˜¾ç¤ºç»“æœ
            const resultContent = `
                <p><strong>å»ºè®®ä»·æ ¼:</strong> ${price.toLocaleString()} é‡‘å¸</p>
                <p><strong>å›æ”¶ä»·å€¼:</strong> ${sellValue.toLocaleString()} é‡‘å¸</p>
                <p><strong>åŸºç¡€å±æ€§å‚è€ƒ:</strong></p>
                <ul>
                    <li>HP: ${baseStats.hp}</li>
                    <li>MP: ${baseStats.mp}</li>
                    <li>æ”»å‡»åŠ›: ${baseStats.attack}</li>
                    <li>é˜²å¾¡åŠ›: ${baseStats.defense}</li>
                </ul>
            `;
            
            document.getElementById('resultContent').innerHTML = resultContent;
            document.getElementById('result').style.display = 'block';
        }
    </script>
</body>
</html>
```

### Excelè®¡ç®—è¡¨æ ¼æ¨¡æ¿
```
A1: ç‰©å“ç­‰çº§    B1: 30
A2: ç¨€æœ‰åº¦      B2: 3
A3: ç‰©å“ç±»å‹    B3: consumable

A5: è®¡ç®—ç»“æœ
A6: åŸºç¡€ä»·æ ¼    B6: =B1*100
A7: ç¨€æœ‰åº¦å€æ•°  B7: =CHOOSE(B2,1,1.5,2.5,4,7,12)
A8: ç±»å‹å€æ•°    B8: =IF(B3="consumable",1,IF(B3="material",0.8,IF(B3="booster",3,1)))
A9: æœ€ç»ˆä»·æ ¼    B9: =B6*B7*B8
A10: å›æ”¶ä»·å€¼   B10: =B9*(0.4+B2*0.05)

A12: å±æ€§å‚è€ƒ
A13: HP        B13: =B1*15+100
A14: MP        B14: =B1*10+50
A15: æ”»å‡»åŠ›    B15: =B1*3+10
A16: é˜²å¾¡åŠ›    B16: =B1*2+5
```

## ğŸ“ˆ æ•°å€¼å¹³è¡¡å»ºè®®

### ç­‰çº§è¿›åº¦æ›²çº¿
```python
def generate_level_curve(max_level=85):
    """ç”Ÿæˆç­‰çº§è¿›åº¦æ›²çº¿"""
    curve = []
    for level in range(1, max_level + 1):
        # æŒ‡æ•°å¢é•¿æ›²çº¿
        exp_required = int(100 * (level ** 1.8))
        
        # å±æ€§å¢é•¿
        hp_growth = level * 15 + 100
        mp_growth = level * 10 + 50
        
        curve.append({
            'level': level,
            'exp_required': exp_required,
            'total_exp': sum(100 * (i ** 1.8) for i in range(1, level)),
            'hp': hp_growth,
            'mp': mp_growth
        })
    
    return curve

# ç”Ÿæˆ1-85çº§æ›²çº¿
level_curve = generate_level_curve()
for i in [1, 10, 20, 30, 40, 50, 60, 70, 80, 85]:
    data = level_curve[i-1]
    print(f"ç­‰çº§{i}: ç»éªŒ{data['exp_required']}, HP{data['hp']}, MP{data['mp']}")
```

### ç¨€æœ‰åº¦åˆ†å¸ƒå»ºè®®
```
ç¨€æœ‰åº¦    å‡ºç°æ¦‚ç‡    ä»·æ ¼å€æ•°    å±æ€§å€æ•°
æ™®é€š(1)   60%        1.0x       1.0x
é«˜çº§(2)   25%        1.5x       1.2x
ç¨€æœ‰(3)   10%        2.5x       1.5x
å²è¯—(4)   4%         4.0x       2.0x
ä¼ è¯´(5)   1%         7.0x       3.0x
ç¥å™¨(6)   0.1%       12.0x      5.0x
```

## ğŸ”— ç›¸å…³é“¾æ¥

- [STKæ–‡ä»¶æ¨¡æ¿](./STKæ–‡ä»¶æ¨¡æ¿.md)
- [æ£€æŸ¥å·¥å…·](./STKæ–‡ä»¶æ£€æŸ¥å·¥å…·.md)
- [åŸºç¡€STKç±»å‹](../01-åŸºç¡€STKç±»å‹/)
- [æ ‡ç­¾ç´¢å¼•](../03-æ ‡ç­¾ç´¢å¼•/)
- [å®é™…ç¤ºä¾‹](../05-å®é™…ç¤ºä¾‹/)

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **æ¸è¿›è°ƒæ•´**: æ•°å€¼è°ƒæ•´åº”è¯¥æ¸è¿›å¼è¿›è¡Œï¼Œé¿å…å¤§å¹…å˜åŠ¨
2. **æ•°æ®é©±åŠ¨**: åŸºäºå®é™…æ¸¸æˆæ•°æ®è¿›è¡Œè°ƒæ•´
3. **ç©å®¶åé¦ˆ**: é‡è§†ç©å®¶å¯¹æ•°å€¼å¹³è¡¡çš„åé¦ˆ
4. **å®šæœŸè¯„ä¼°**: å®šæœŸè¯„ä¼°æ•°å€¼å¹³è¡¡çŠ¶å†µ
5. **æ–‡æ¡£è®°å½•**: è¯¦ç»†è®°å½•æ¯æ¬¡æ•°å€¼è°ƒæ•´çš„åŸå› å’Œæ•ˆæœ