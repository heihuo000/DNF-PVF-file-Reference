# OBJ文件概述

## 📖 什么是OBJ文件

OBJ文件（Object File）是DNF中用于定义**被动对象**（Passive Object）的配置文件。被动对象是游戏中不主动移动但能与环境和角色产生交互的实体，是实现复杂技能效果、环境机制和视觉特效的重要组件。

## 🎯 被动对象的特征

### 被动性
- 不会主动移动或寻找目标
- 通常在固定位置或按预设轨迹运动
- 由技能、装备效果或其他事件触发创建

### 交互性
- 可以检测碰撞和接触
- 能够对角色、怪物产生影响
- 支持复杂的触发条件和响应机制

### 时效性
- 具有明确的生命周期
- 可以设置多种销毁条件
- 支持定时销毁和条件销毁

## 🔧 OBJ文件的作用

### 技能效果实现
```obj
# 示例：雷击特效对象
[name]
`雷击特效`

[basic action]
`Action/thunder_strike.act`

[attack info]
`AttackInfo/thunder_damage.atk`
```

### 环境交互
- **陷阱机关**：地刺、毒雾、爆炸装置
- **传送门**：空间传送、场景切换
- **收集物品**：宝箱、道具、材料

### 视觉特效
- **粒子效果**：火花、烟雾、光效
- **环境装饰**：背景元素、氛围效果
- **UI提示**：伤害数字、状态图标

## 📁 文件位置和命名

### 标准路径
```
pvf/
├── passiveobject/          # 被动对象目录
│   ├── character/          # 角色相关对象
│   ├── monster/            # 怪物相关对象
│   ├── common/             # 通用对象
│   └── skill/              # 技能对象
```

### 命名规范
- **描述性命名**：`thunder_strike.obj`（雷击）
- **分类前缀**：`skill_fireball.obj`（技能-火球）
- **版本标识**：`trap_spike_v2.obj`（陷阱-地刺v2）

## 🔗 与其他文件的关系

### 依赖文件类型

#### ACT文件（动作文件）
```obj
[basic action]
`Action/thunder_effect.act`    # 定义动画和时序
```

#### ATK文件（攻击文件）
```obj
[attack info]
`AttackInfo/lightning_damage.atk`    # 定义伤害和效果
```

#### ANI文件（动画文件）
- 通过ACT文件间接引用
- 提供视觉动画效果

#### 音效文件
```obj
[hit wav]
`THUNDER_STRIKE`    # 音效标识
```

### 被引用方式

#### 装备文件（.equ）
```equ
[passive object]
35881	0	0	0	99	-1	``    # 创建OBJ对象
```

#### 技能文件（.skl）
```skl
[create passive object]
`passiveobject/skill_effect.obj`    # 直接引用
```

## 🎮 游戏中的表现

### 创建时机
1. **技能释放**：技能动作触发
2. **装备效果**：装备属性激活
3. **环境触发**：进入特定区域
4. **时间事件**：定时创建机制

### 生命周期
1. **创建阶段**：读取配置，初始化属性
2. **活跃阶段**：执行动画，检测交互
3. **销毁阶段**：满足条件，清理资源

### 性能影响
- **数量限制**：同时存在的对象数量
- **计算开销**：碰撞检测和效果计算
- **内存占用**：贴图和动画资源

## ⚠️ 重要概念

### 图层系统
```obj
[layer]
`[bottom]`     # 底层：在角色下方
`[normal]`     # 普通：与角色同层
`[cover]`      # 覆盖：在角色上方
```

### 通过类型
```obj
[pass type]
`[pass all]`        # 所有单位可通过
`[do not pass]`     # 所有单位不可通过
`[pass friend]`     # 友方可通过
`[pass enemy]`      # 敌方可通过
```

### 穿刺力
```obj
[piercing power]
1000    # 穿刺力值，影响对象穿透能力
```

## 📚 学习建议

### 入门步骤
1. **理解概念**：掌握被动对象的基本特征
2. **分析示例**：研究现有的OBJ文件
3. **简单修改**：调整参数观察效果变化
4. **创建测试**：制作简单的测试对象

### 进阶方向
1. **复杂交互**：多对象协作机制
2. **性能优化**：减少资源消耗
3. **特效制作**：高质量视觉效果
4. **系统集成**：与其他系统的整合

## 🔍 调试技巧

### 常见问题
- **对象不显示**：检查ACT和ANI文件路径
- **没有伤害**：验证ATK文件配置
- **位置错误**：确认坐标和图层设置
- **性能问题**：优化对象数量和复杂度

### 测试方法
1. **游戏内测试**：实际效果验证
2. **日志分析**：查看错误信息
3. **分步调试**：逐个功能测试
4. **对比参考**：与工作正常的文件对比

---

*下一步：学习 [文件结构说明](文件结构说明.md)*