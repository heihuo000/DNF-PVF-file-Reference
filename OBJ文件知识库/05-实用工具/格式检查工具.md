# æ ¼å¼æ£€æŸ¥å·¥å…·

## ğŸ” è‡ªåŠ¨æ£€æŸ¥å·¥å…·

### PVFæ ¼å¼éªŒè¯å™¨

#### åŠŸèƒ½ç‰¹ç‚¹
- **è¯­æ³•æ£€æŸ¥**ï¼šéªŒè¯æ ‡ç­¾æ ¼å¼å’ŒåµŒå¥—ç»“æ„
- **å­—ç¬¦ä¸²æ£€æŸ¥**ï¼šç¡®ä¿ä½¿ç”¨åå¼•å·è€ŒéåŒå¼•å·
- **ç¼©è¿›æ£€æŸ¥**ï¼šéªŒè¯Tabç¼©è¿›çš„æ­£ç¡®ä½¿ç”¨
- **ä¾èµ–æ£€æŸ¥**ï¼šéªŒè¯å¼•ç”¨æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- **ç¼–ç æ£€æŸ¥**ï¼šç¡®ä¿æ–‡ä»¶ç¼–ç æ­£ç¡®

#### ä½¿ç”¨æ–¹æ³•

**å‘½ä»¤è¡Œç‰ˆæœ¬**ï¼š
```bash
# æ£€æŸ¥å•ä¸ªæ–‡ä»¶
python pvf_checker.py example.obj

# æ‰¹é‡æ£€æŸ¥ç›®å½•
python pvf_checker.py --dir ./passiveobject/

# ç”Ÿæˆæ£€æŸ¥æŠ¥å‘Š
python pvf_checker.py --report --output check_report.html
```

**å›¾å½¢ç•Œé¢ç‰ˆæœ¬**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PVFæ ¼å¼æ£€æŸ¥å™¨ v1.0                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ–‡ä»¶è·¯å¾„: [é€‰æ‹©æ–‡ä»¶...] [æµè§ˆ]      â”‚
â”‚ æ£€æŸ¥é€‰é¡¹: â˜‘è¯­æ³• â˜‘å­—ç¬¦ä¸² â˜‘ç¼©è¿›      â”‚
â”‚ è¾“å‡ºæ ¼å¼: â—‹æ§åˆ¶å° â—HTMLæŠ¥å‘Š        â”‚
â”‚                                     â”‚
â”‚ [å¼€å§‹æ£€æŸ¥] [æ¸…é™¤ç»“æœ] [ä¿å­˜æŠ¥å‘Š]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ£€æŸ¥ç»“æœ:                           â”‚
â”‚ âœ“ è¯­æ³•ç»“æ„æ­£ç¡®                      â”‚
â”‚ âœ— ç¬¬15è¡Œ: å‘ç°åŒå¼•å·                â”‚
â”‚ âœ— ç¬¬23è¡Œ: ç¼©è¿›ä½¿ç”¨ç©ºæ ¼              â”‚
â”‚ âš  ç¬¬30è¡Œ: å¼•ç”¨æ–‡ä»¶ä¸å­˜åœ¨            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¯¦ç»†æ£€æŸ¥è„šæœ¬

#### Pythonå®Œæ•´ç‰ˆæœ¬
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
PVFæ–‡ä»¶æ ¼å¼æ£€æŸ¥å™¨
æ”¯æŒOBJã€EQUã€SKLç­‰PVFæ ¼å¼æ–‡ä»¶çš„è¯­æ³•æ£€æŸ¥
"""

import os
import re
import sys
import json
import argparse
from pathlib import Path
from typing import List, Dict, Tuple

class PVFChecker:
    """PVFæ–‡ä»¶æ ¼å¼æ£€æŸ¥å™¨"""
    
    def __init__(self):
        self.errors = []
        self.warnings = []
        self.info = []
        
        # å®šä¹‰æ£€æŸ¥è§„åˆ™
        self.rules = {
            'required_tags': ['[name]'],
            'string_pattern': r'`[^`]*`',
            'invalid_string_pattern': r'"[^"]*"',
            'tag_pattern': r'\[[^\]]+\]',
            'comment_pattern': r'#.*$',
            'tab_pattern': r'^\t+',
            'space_indent_pattern': r'^[ ]{2,}'
        }
    
    def check_file(self, filepath: str) -> Dict:
        """æ£€æŸ¥å•ä¸ªæ–‡ä»¶"""
        self.errors.clear()
        self.warnings.clear()
        self.info.clear()
        
        if not os.path.exists(filepath):
            self.errors.append(f"æ–‡ä»¶ä¸å­˜åœ¨: {filepath}")
            return self._get_result()
        
        try:
            with open(filepath, 'r', encoding='utf-8') as f:
                lines = f.readlines()
        except UnicodeDecodeError:
            try:
                with open(filepath, 'r', encoding='gbk') as f:
                    lines = f.readlines()
                self.warnings.append("æ–‡ä»¶ç¼–ç ä¸ºGBKï¼Œå»ºè®®ä½¿ç”¨UTF-8")
            except Exception as e:
                self.errors.append(f"æ— æ³•è¯»å–æ–‡ä»¶: {e}")
                return self._get_result()
        except Exception as e:
            self.errors.append(f"è¯»å–æ–‡ä»¶æ—¶å‡ºé”™: {e}")
            return self._get_result()
        
        # æ‰§è¡Œå„é¡¹æ£€æŸ¥
        self._check_file_header(lines)
        self._check_string_format(lines)
        self._check_indentation(lines)
        self._check_required_tags(lines)
        self._check_tag_structure(lines)
        self._check_file_references(lines, filepath)
        
        return self._get_result()
    
    def _check_file_header(self, lines: List[str]):
        """æ£€æŸ¥æ–‡ä»¶å¤´"""
        if not lines:
            self.errors.append("æ–‡ä»¶ä¸ºç©º")
            return
        
        first_line = lines[0].strip()
        if not first_line.startswith('#PVF_File'):
            self.errors.append("ç¼ºå°‘æ–‡ä»¶å¤´ #PVF_File")
    
    def _check_string_format(self, lines: List[str]):
        """æ£€æŸ¥å­—ç¬¦ä¸²æ ¼å¼"""
        for i, line in enumerate(lines, 1):
            # è·³è¿‡æ³¨é‡Šè¡Œ
            if line.strip().startswith('#'):
                continue
            
            # æ£€æŸ¥åŒå¼•å·
            if re.search(self.rules['invalid_string_pattern'], line):
                self.errors.append(f"ç¬¬{i}è¡Œ: å‘ç°åŒå¼•å·ï¼Œåº”ä½¿ç”¨åå¼•å·")
            
            # æ£€æŸ¥æœªé—­åˆçš„åå¼•å·
            backtick_count = line.count('`')
            if backtick_count % 2 != 0:
                self.warnings.append(f"ç¬¬{i}è¡Œ: åå¼•å·æœªæˆå¯¹å‡ºç°")
    
    def _check_indentation(self, lines: List[str]):
        """æ£€æŸ¥ç¼©è¿›æ ¼å¼"""
        for i, line in enumerate(lines, 1):
            # æ£€æŸ¥ç©ºæ ¼ç¼©è¿›
            if re.match(self.rules['space_indent_pattern'], line):
                self.errors.append(f"ç¬¬{i}è¡Œ: ä½¿ç”¨ç©ºæ ¼ç¼©è¿›ï¼Œåº”ä½¿ç”¨Tab")
            
            # æ£€æŸ¥æ··åˆç¼©è¿›
            if line.startswith('\t') and '    ' in line[:10]:
                self.warnings.append(f"ç¬¬{i}è¡Œ: æ··åˆä½¿ç”¨Tabå’Œç©ºæ ¼")
    
    def _check_required_tags(self, lines: List[str]):
        """æ£€æŸ¥å¿…éœ€æ ‡ç­¾"""
        content = ''.join(lines)
        
        for tag in self.rules['required_tags']:
            if tag not in content:
                self.errors.append(f"ç¼ºå°‘å¿…éœ€æ ‡ç­¾: {tag}")
    
    def _check_tag_structure(self, lines: List[str]):
        """æ£€æŸ¥æ ‡ç­¾ç»“æ„"""
        tag_stack = []
        
        for i, line in enumerate(lines, 1):
            line = line.strip()
            if not line or line.startswith('#'):
                continue
            
            # æŸ¥æ‰¾æ ‡ç­¾
            tags = re.findall(self.rules['tag_pattern'], line)
            for tag in tags:
                if tag.startswith('[/'):
                    # ç»“æŸæ ‡ç­¾
                    expected_start = tag[2:-1]
                    if not tag_stack:
                        self.errors.append(f"ç¬¬{i}è¡Œ: æœªåŒ¹é…çš„ç»“æŸæ ‡ç­¾ {tag}")
                    elif tag_stack[-1] != expected_start:
                        self.errors.append(f"ç¬¬{i}è¡Œ: æ ‡ç­¾ä¸åŒ¹é…ï¼ŒæœŸæœ› [/{tag_stack[-1]}]ï¼Œå®é™… {tag}")
                    else:
                        tag_stack.pop()
                elif not any(tag.endswith(end) for end in [']', '`']):
                    # å¼€å§‹æ ‡ç­¾ï¼ˆæ’é™¤å•è¡Œæ ‡ç­¾ï¼‰
                    tag_name = tag[1:-1]
                    tag_stack.append(tag_name)
        
        # æ£€æŸ¥æœªé—­åˆçš„æ ‡ç­¾
        if tag_stack:
            self.warnings.append(f"æœªé—­åˆçš„æ ‡ç­¾: {tag_stack}")
    
    def _check_file_references(self, lines: List[str], current_file: str):
        """æ£€æŸ¥æ–‡ä»¶å¼•ç”¨"""
        base_dir = os.path.dirname(current_file)
        
        for i, line in enumerate(lines, 1):
            # æŸ¥æ‰¾æ–‡ä»¶å¼•ç”¨
            matches = re.findall(r'`([^`]*\.(act|atk|ani|wav|ogg))`', line, re.IGNORECASE)
            
            for match in matches:
                ref_file = match[0]
                
                # æ„å»ºå®Œæ•´è·¯å¾„
                if not os.path.isabs(ref_file):
                    full_path = os.path.join(base_dir, ref_file)
                else:
                    full_path = ref_file
                
                if not os.path.exists(full_path):
                    self.warnings.append(f"ç¬¬{i}è¡Œ: å¼•ç”¨æ–‡ä»¶ä¸å­˜åœ¨ - {ref_file}")
    
    def _get_result(self) -> Dict:
        """è·å–æ£€æŸ¥ç»“æœ"""
        return {
            'errors': self.errors.copy(),
            'warnings': self.warnings.copy(),
            'info': self.info.copy(),
            'total_issues': len(self.errors) + len(self.warnings)
        }

class PVFBatchChecker:
    """æ‰¹é‡æ£€æŸ¥å™¨"""
    
    def __init__(self):
        self.checker = PVFChecker()
    
    def check_directory(self, directory: str, extensions: List[str] = None) -> Dict:
        """æ£€æŸ¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶"""
        if extensions is None:
            extensions = ['.obj', '.equ', '.skl']
        
        results = {}
        total_files = 0
        total_errors = 0
        total_warnings = 0
        
        for root, dirs, files in os.walk(directory):
            for file in files:
                if any(file.lower().endswith(ext) for ext in extensions):
                    filepath = os.path.join(root, file)
                    result = self.checker.check_file(filepath)
                    
                    results[filepath] = result
                    total_files += 1
                    total_errors += len(result['errors'])
                    total_warnings += len(result['warnings'])
        
        return {
            'files': results,
            'summary': {
                'total_files': total_files,
                'total_errors': total_errors,
                'total_warnings': total_warnings,
                'clean_files': sum(1 for r in results.values() if r['total_issues'] == 0)
            }
        }
    
    def generate_html_report(self, results: Dict, output_file: str):
        """ç”ŸæˆHTMLæŠ¥å‘Š"""
        html_template = """
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>PVFæ ¼å¼æ£€æŸ¥æŠ¥å‘Š</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .summary { background: #f0f0f0; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
        .file-result { margin-bottom: 20px; border: 1px solid #ddd; border-radius: 5px; }
        .file-header { background: #e9e9e9; padding: 10px; font-weight: bold; }
        .error { color: #d32f2f; margin: 5px 0; }
        .warning { color: #f57c00; margin: 5px 0; }
        .success { color: #388e3c; }
        .issues { padding: 10px; }
    </style>
</head>
<body>
    <h1>PVFæ ¼å¼æ£€æŸ¥æŠ¥å‘Š</h1>
    
    <div class="summary">
        <h2>æ£€æŸ¥æ‘˜è¦</h2>
        <p>æ€»æ–‡ä»¶æ•°: {total_files}</p>
        <p>é”™è¯¯æ€»æ•°: {total_errors}</p>
        <p>è­¦å‘Šæ€»æ•°: {total_warnings}</p>
        <p>æ— é—®é¢˜æ–‡ä»¶: {clean_files}</p>
    </div>
    
    <div class="results">
        <h2>è¯¦ç»†ç»“æœ</h2>
        {file_results}
    </div>
</body>
</html>
        """
        
        file_results_html = ""
        for filepath, result in results['files'].items():
            status_class = "success" if result['total_issues'] == 0 else "error"
            status_text = "âœ“ é€šè¿‡" if result['total_issues'] == 0 else f"âœ— {result['total_issues']} ä¸ªé—®é¢˜"
            
            issues_html = ""
            for error in result['errors']:
                issues_html += f'<div class="error">âœ— é”™è¯¯: {error}</div>'
            for warning in result['warnings']:
                issues_html += f'<div class="warning">âš  è­¦å‘Š: {warning}</div>'
            
            file_results_html += f"""
            <div class="file-result">
                <div class="file-header">
                    <span class="{status_class}">{status_text}</span> - {os.path.basename(filepath)}
                    <br><small>{filepath}</small>
                </div>
                <div class="issues">{issues_html or '<div class="success">æ— é—®é¢˜</div>'}</div>
            </div>
            """
        
        html_content = html_template.format(
            total_files=results['summary']['total_files'],
            total_errors=results['summary']['total_errors'],
            total_warnings=results['summary']['total_warnings'],
            clean_files=results['summary']['clean_files'],
            file_results=file_results_html
        )
        
        with open(output_file, 'w', encoding='utf-8') as f:
            f.write(html_content)

def main():
    parser = argparse.ArgumentParser(description='PVFæ–‡ä»¶æ ¼å¼æ£€æŸ¥å™¨')
    parser.add_argument('path', help='è¦æ£€æŸ¥çš„æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„')
    parser.add_argument('--dir', action='store_true', help='æ£€æŸ¥æ•´ä¸ªç›®å½•')
    parser.add_argument('--report', action='store_true', help='ç”ŸæˆHTMLæŠ¥å‘Š')
    parser.add_argument('--output', default='check_report.html', help='æŠ¥å‘Šè¾“å‡ºæ–‡ä»¶å')
    parser.add_argument('--extensions', nargs='+', default=['.obj', '.equ', '.skl'], 
                       help='è¦æ£€æŸ¥çš„æ–‡ä»¶æ‰©å±•å')
    
    args = parser.parse_args()
    
    if args.dir or os.path.isdir(args.path):
        # æ‰¹é‡æ£€æŸ¥
        batch_checker = PVFBatchChecker()
        results = batch_checker.check_directory(args.path, args.extensions)
        
        print(f"æ£€æŸ¥å®Œæˆï¼")
        print(f"æ€»æ–‡ä»¶æ•°: {results['summary']['total_files']}")
        print(f"é”™è¯¯æ€»æ•°: {results['summary']['total_errors']}")
        print(f"è­¦å‘Šæ€»æ•°: {results['summary']['total_warnings']}")
        print(f"æ— é—®é¢˜æ–‡ä»¶: {results['summary']['clean_files']}")
        
        if args.report:
            batch_checker.generate_html_report(results, args.output)
            print(f"HTMLæŠ¥å‘Šå·²ç”Ÿæˆ: {args.output}")
        
        # æ˜¾ç¤ºæœ‰é—®é¢˜çš„æ–‡ä»¶
        for filepath, result in results['files'].items():
            if result['total_issues'] > 0:
                print(f"\n{filepath}:")
                for error in result['errors']:
                    print(f"  âœ— é”™è¯¯: {error}")
                for warning in result['warnings']:
                    print(f"  âš  è­¦å‘Š: {warning}")
    
    else:
        # å•æ–‡ä»¶æ£€æŸ¥
        checker = PVFChecker()
        result = checker.check_file(args.path)
        
        print(f"æ£€æŸ¥æ–‡ä»¶: {args.path}")
        
        if result['total_issues'] == 0:
            print("âœ“ æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼")
        else:
            print(f"å‘ç° {result['total_issues']} ä¸ªé—®é¢˜:")
            for error in result['errors']:
                print(f"  âœ— é”™è¯¯: {error}")
            for warning in result['warnings']:
                print(f"  âš  è­¦å‘Š: {warning}")

if __name__ == "__main__":
    main()
```

## ğŸ› ï¸ å¿«é€Ÿæ£€æŸ¥å·¥å…·

### ä¸€é”®æ£€æŸ¥è„šæœ¬

#### Windowsæ‰¹å¤„ç†ç‰ˆæœ¬
```batch
@echo off
chcp 65001 >nul
setlocal enabledelayedexpansion

echo ================================
echo     PVFæ–‡ä»¶å¿«é€Ÿæ£€æŸ¥å·¥å…·
echo ================================
echo.

set /a total_files=0
set /a error_files=0
set /a total_errors=0

REM æ£€æŸ¥å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰OBJæ–‡ä»¶
for %%f in (*.obj) do (
    set /a total_files+=1
    set current_errors=0
    
    echo æ£€æŸ¥æ–‡ä»¶: %%f
    
    REM æ£€æŸ¥æ–‡ä»¶å¤´
    findstr /b "#PVF_File" "%%f" >nul 2>&1
    if !errorlevel! neq 0 (
        echo   âœ— é”™è¯¯: ç¼ºå°‘æ–‡ä»¶å¤´ #PVF_File
        set /a current_errors+=1
    )
    
    REM æ£€æŸ¥åŒå¼•å·
    findstr /n "\"" "%%f" | findstr /v "^[0-9]*:#" >nul 2>&1
    if !errorlevel! equ 0 (
        echo   âœ— é”™è¯¯: å‘ç°åŒå¼•å·ï¼Œåº”ä½¿ç”¨åå¼•å·
        set /a current_errors+=1
    )
    
    REM æ£€æŸ¥å¿…éœ€æ ‡ç­¾
    findstr "\[name\]" "%%f" >nul 2>&1
    if !errorlevel! neq 0 (
        echo   âœ— é”™è¯¯: ç¼ºå°‘å¿…éœ€æ ‡ç­¾ [name]
        set /a current_errors+=1
    )
    
    REM æ£€æŸ¥ç©ºæ ¼ç¼©è¿›
    findstr /r "^  " "%%f" >nul 2>&1
    if !errorlevel! equ 0 (
        echo   âš  è­¦å‘Š: å‘ç°ç©ºæ ¼ç¼©è¿›ï¼Œå»ºè®®ä½¿ç”¨Tab
        set /a current_errors+=1
    )
    
    if !current_errors! equ 0 (
        echo   âœ“ æ ¼å¼æ­£ç¡®
    ) else (
        set /a error_files+=1
        set /a total_errors+=!current_errors!
    )
    echo.
)

echo ================================
echo æ£€æŸ¥å®Œæˆï¼
echo æ€»æ–‡ä»¶æ•°: !total_files!
echo æœ‰é—®é¢˜æ–‡ä»¶: !error_files!
echo æ€»é—®é¢˜æ•°: !total_errors!
echo ================================

if !error_files! equ 0 (
    echo âœ“ æ‰€æœ‰æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼
) else (
    echo âš  å‘ç°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ä¸Šè¿°é”™è¯¯
)

pause
```

### åœ¨çº¿æ£€æŸ¥å·¥å…·

#### Webç‰ˆæœ¬ç•Œé¢
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>PVFåœ¨çº¿æ ¼å¼æ£€æŸ¥å™¨</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .upload-area { border: 2px dashed #ccc; padding: 40px; text-align: center; margin: 20px 0; }
        .upload-area.dragover { border-color: #007cba; background: #f0f8ff; }
        .result { margin: 20px 0; padding: 15px; border-radius: 5px; }
        .result.success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .result.error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .result.warning { background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; }
        textarea { width: 100%; height: 300px; font-family: monospace; }
        button { background: #007cba; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        button:hover { background: #005a87; }
    </style>
</head>
<body>
    <h1>PVFåœ¨çº¿æ ¼å¼æ£€æŸ¥å™¨</h1>
    
    <div class="upload-area" id="uploadArea">
        <p>æ‹–æ‹½OBJæ–‡ä»¶åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</p>
        <input type="file" id="fileInput" accept=".obj" style="display: none;">
        <button onclick="document.getElementById('fileInput').click()">é€‰æ‹©æ–‡ä»¶</button>
    </div>
    
    <div>
        <h3>æˆ–ç›´æ¥ç²˜è´´ä»£ç ï¼š</h3>
        <textarea id="codeInput" placeholder="åœ¨æ­¤ç²˜è´´OBJæ–‡ä»¶å†…å®¹..."></textarea>
        <br><br>
        <button onclick="checkCode()">æ£€æŸ¥æ ¼å¼</button>
        <button onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
    </div>
    
    <div id="results"></div>
    
    <script>
        // æ–‡ä»¶æ‹–æ‹½å¤„ç†
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });
        
        function handleFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('codeInput').value = e.target.result;
                checkCode();
            };
            reader.readAsText(file, 'utf-8');
        }
        
        function checkCode() {
            const code = document.getElementById('codeInput').value;
            if (!code.trim()) {
                showResult('è¯·è¾“å…¥æˆ–é€‰æ‹©OBJæ–‡ä»¶å†…å®¹', 'warning');
                return;
            }
            
            const results = performCheck(code);
            displayResults(results);
        }
        
        function performCheck(code) {
            const lines = code.split('\n');
            const errors = [];
            const warnings = [];
            
            // æ£€æŸ¥æ–‡ä»¶å¤´
            if (!lines[0] || !lines[0].trim().startsWith('#PVF_File')) {
                errors.push('ç¼ºå°‘æ–‡ä»¶å¤´ #PVF_File');
            }
            
            // æ£€æŸ¥æ¯ä¸€è¡Œ
            lines.forEach((line, index) => {
                const lineNum = index + 1;
                
                // è·³è¿‡æ³¨é‡Šè¡Œ
                if (line.trim().startsWith('#')) return;
                
                // æ£€æŸ¥åŒå¼•å·
                if (line.includes('"') && !line.trim().startsWith('#')) {
                    errors.push(`ç¬¬${lineNum}è¡Œ: å‘ç°åŒå¼•å·ï¼Œåº”ä½¿ç”¨åå¼•å·`);
                }
                
                // æ£€æŸ¥ç©ºæ ¼ç¼©è¿›
                if (/^  /.test(line)) {
                    warnings.push(`ç¬¬${lineNum}è¡Œ: ä½¿ç”¨ç©ºæ ¼ç¼©è¿›ï¼Œå»ºè®®ä½¿ç”¨Tab`);
                }
                
                // æ£€æŸ¥æœªé—­åˆçš„åå¼•å·
                const backtickCount = (line.match(/`/g) || []).length;
                if (backtickCount % 2 !== 0) {
                    warnings.push(`ç¬¬${lineNum}è¡Œ: åå¼•å·æœªæˆå¯¹å‡ºç°`);
                }
            });
            
            // æ£€æŸ¥å¿…éœ€æ ‡ç­¾
            if (!code.includes('[name]')) {
                errors.push('ç¼ºå°‘å¿…éœ€æ ‡ç­¾ [name]');
            }
            
            return { errors, warnings };
        }
        
        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';
            
            if (results.errors.length === 0 && results.warnings.length === 0) {
                showResult('âœ“ æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼', 'success');
                return;
            }
            
            if (results.errors.length > 0) {
                const errorHtml = '<h4>é”™è¯¯ï¼š</h4><ul>' + 
                    results.errors.map(error => `<li>âœ— ${error}</li>`).join('') + 
                    '</ul>';
                showResult(errorHtml, 'error');
            }
            
            if (results.warnings.length > 0) {
                const warningHtml = '<h4>è­¦å‘Šï¼š</h4><ul>' + 
                    results.warnings.map(warning => `<li>âš  ${warning}</li>`).join('') + 
                    '</ul>';
                showResult(warningHtml, 'warning');
            }
        }
        
        function showResult(message, type) {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = message;
            resultsDiv.appendChild(resultDiv);
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('codeInput').value = '';
        }
    </script>
</body>
</html>
```

## ğŸ“Š æ£€æŸ¥æŠ¥å‘Šç¤ºä¾‹

### æ§åˆ¶å°è¾“å‡ºæ ¼å¼
```
PVFæ ¼å¼æ£€æŸ¥æŠ¥å‘Š
================

æ–‡ä»¶: example.obj
âœ“ æ–‡ä»¶å¤´æ­£ç¡®
âœ— ç¬¬15è¡Œ: å‘ç°åŒå¼•å·ï¼Œåº”ä½¿ç”¨åå¼•å·
âš  ç¬¬23è¡Œ: ä½¿ç”¨ç©ºæ ¼ç¼©è¿›ï¼Œå»ºè®®ä½¿ç”¨Tab
âœ— ç¬¬30è¡Œ: ç¼ºå°‘å¿…éœ€æ ‡ç­¾ [name]

æ€»è®¡: 2ä¸ªé”™è¯¯, 1ä¸ªè­¦å‘Š

å»ºè®®ä¿®å¤:
1. å°†ç¬¬15è¡Œçš„åŒå¼•å·æ”¹ä¸ºåå¼•å·
2. å°†ç¬¬23è¡Œçš„ç©ºæ ¼ç¼©è¿›æ”¹ä¸ºTabç¼©è¿›
3. æ·»åŠ  [name] æ ‡ç­¾
```

### HTMLæŠ¥å‘Šæ ¼å¼
- **æ¦‚è§ˆç»Ÿè®¡**ï¼šæ–‡ä»¶æ€»æ•°ã€é”™è¯¯æ•°ã€è­¦å‘Šæ•°
- **æ–‡ä»¶åˆ—è¡¨**ï¼šæ¯ä¸ªæ–‡ä»¶çš„æ£€æŸ¥çŠ¶æ€
- **è¯¦ç»†é—®é¢˜**ï¼šå…·ä½“çš„é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯
- **ä¿®å¤å»ºè®®**ï¼šé’ˆå¯¹æ€§çš„è§£å†³æ–¹æ¡ˆ

---

*ä¸‹ä¸€æ­¥ï¼šæŸ¥çœ‹ [è°ƒè¯•æŠ€å·§](../04-å¸¸è§é—®é¢˜/è°ƒè¯•æŠ€å·§.md)*